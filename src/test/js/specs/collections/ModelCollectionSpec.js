/* global expect */

define([
	"sinon",
	'collections/ModelCollection',
	'underscore'
], function (sinon, ModelCollection, _) {
	describe("ModelCollection", function () {

		var json = {"total":27,"took":"69ms","selflink":{"rel":"self","url":"https://www.sciencebase.gov/catalog/items?max=1000&format=json&fields=tags&parentId=55c90c3be4b08400b1fd88a2"},"items":[{"link":{"rel":"self","url":"https://www.sciencebase.gov/catalog/item/55ce4032e4b01487cbfc70d4"},"relatedItems":{"link":{"url":"https://www.sciencebase.gov/catalog/itemLinks?itemId=55ce4032e4b01487cbfc70d4","rel":"related"}},"id":"55ce4032e4b01487cbfc70d4","tags":[{"type":"region","scheme":"https://www.sciencebase.gov/vocab/SPARROW/region","name":"Southeast (MRB2)"},{"type":"id","scheme":"https://www.sciencebase.gov/vocab/SPARROW/sparrow-id","name":"50"},{"type":"extent","scheme":"https://www.sciencebase.gov/vocab/SPARROW/extent","name":"Region (MRB) - Default for state selection"},{"type":"constituent","scheme":"https://www.sciencebase.gov/vocab/SPARROW/constituent","name":"TN"}]},{"link":{"rel":"self","url":"https://www.sciencebase.gov/catalog/item/55ce4031e4b01487cbfc70c6"},"relatedItems":{"link":{"url":"https://www.sciencebase.gov/catalog/itemLinks?itemId=55ce4031e4b01487cbfc70c6","rel":"related"}},"id":"55ce4031e4b01487cbfc70c6","tags":[{"type":"region","scheme":"https://www.sciencebase.gov/vocab/SPARROW/region","name":"Conterminous US"},{"type":"id","scheme":"https://www.sciencebase.gov/vocab/SPARROW/sparrow-id","name":"24"},{"type":"extent","scheme":"https://www.sciencebase.gov/vocab/SPARROW/extent","name":"Conterminous US"},{"type":"constituent","scheme":"https://www.sciencebase.gov/vocab/SPARROW/constituent","name":"TOC"}]},{"link":{"rel":"self","url":"https://www.sciencebase.gov/catalog/item/55ce4032e4b01487cbfc70de"},"relatedItems":{"link":{"url":"https://www.sciencebase.gov/catalog/itemLinks?itemId=55ce4032e4b01487cbfc70de","rel":"related"}},"id":"55ce4032e4b01487cbfc70de","tags":[{"type":"region","scheme":"https://www.sciencebase.gov/vocab/SPARROW/region","name":"Missouri (MRB4)"},{"type":"id","scheme":"https://www.sciencebase.gov/vocab/SPARROW/sparrow-id","name":"58"},{"type":"extent","scheme":"https://www.sciencebase.gov/vocab/SPARROW/extent","name":"Region (MRB) - Default for state selection"},{"type":"constituent","scheme":"https://www.sciencebase.gov/vocab/SPARROW/constituent","name":"TP"}]},{"link":{"rel":"self","url":"https://www.sciencebase.gov/catalog/item/55ce4032e4b01487cbfc70e8"},"relatedItems":{"link":{"url":"https://www.sciencebase.gov/catalog/itemLinks?itemId=55ce4032e4b01487cbfc70e8","rel":"related"}},"id":"55ce4032e4b01487cbfc70e8","tags":[{"type":"region","scheme":"https://www.sciencebase.gov/vocab/SPARROW/region","name":"California (MRB8)"},{"type":"id","scheme":"https://www.sciencebase.gov/vocab/SPARROW/sparrow-id","name":"New"},{"type":"extent","scheme":"https://www.sciencebase.gov/vocab/SPARROW/extent","name":"Region (MRB) - Default for state selection"},{"type":"constituent","scheme":"https://www.sciencebase.gov/vocab/SPARROW/constituent","name":"TN"}]},{"link":{"rel":"self","url":"https://www.sciencebase.gov/catalog/item/55ce4031e4b01487cbfc70ce"},"relatedItems":{"link":{"url":"https://www.sciencebase.gov/catalog/itemLinks?itemId=55ce4031e4b01487cbfc70ce","rel":"related"}},"id":"55ce4031e4b01487cbfc70ce","tags":[{"type":"region","scheme":"https://www.sciencebase.gov/vocab/SPARROW/region","name":"East Coast"},{"type":"id","scheme":"https://www.sciencebase.gov/vocab/SPARROW/sparrow-id","name":"New"},{"type":"extent","scheme":"https://www.sciencebase.gov/vocab/SPARROW/extent","name":"Super-Region"},{"type":"constituent","scheme":"https://www.sciencebase.gov/vocab/SPARROW/constituent","name":"TP"}]},{"link":{"rel":"self","url":"https://www.sciencebase.gov/catalog/item/55ce4032e4b01487cbfc70d6"},"relatedItems":{"link":{"url":"https://www.sciencebase.gov/catalog/itemLinks?itemId=55ce4032e4b01487cbfc70d6","rel":"related"}},"id":"55ce4032e4b01487cbfc70d6","tags":[{"type":"region","scheme":"https://www.sciencebase.gov/vocab/SPARROW/region","name":"Southeast (MRB2)"},{"type":"id","scheme":"https://www.sciencebase.gov/vocab/SPARROW/sparrow-id","name":"49"},{"type":"extent","scheme":"https://www.sciencebase.gov/vocab/SPARROW/extent","name":"Region (MRB) - Default for state selection"},{"type":"constituent","scheme":"https://www.sciencebase.gov/vocab/SPARROW/constituent","name":"TP"}]},{"link":{"rel":"self","url":"https://www.sciencebase.gov/catalog/item/55ce4031e4b01487cbfc70c4"},"relatedItems":{"link":{"url":"https://www.sciencebase.gov/catalog/itemLinks?itemId=55ce4031e4b01487cbfc70c4","rel":"related"}},"id":"55ce4031e4b01487cbfc70c4","tags":[{"type":"region","scheme":"https://www.sciencebase.gov/vocab/SPARROW/region","name":"Conterminous US"},{"type":"id","scheme":"https://www.sciencebase.gov/vocab/SPARROW/sparrow-id","name":"25"},{"type":"extent","scheme":"https://www.sciencebase.gov/vocab/SPARROW/extent","name":"Conterminous US"},{"type":"constituent","scheme":"https://www.sciencebase.gov/vocab/SPARROW/constituent","name":"TDS"}]},{"link":{"rel":"self","url":"https://www.sciencebase.gov/catalog/item/55ce4031e4b01487cbfc70cc"},"relatedItems":{"link":{"url":"https://www.sciencebase.gov/catalog/itemLinks?itemId=55ce4031e4b01487cbfc70cc","rel":"related"}},"id":"55ce4031e4b01487cbfc70cc","tags":[{"type":"region","scheme":"https://www.sciencebase.gov/vocab/SPARROW/region","name":"East Coast"},{"type":"id","scheme":"https://www.sciencebase.gov/vocab/SPARROW/sparrow-id","name":"New"},{"type":"extent","scheme":"https://www.sciencebase.gov/vocab/SPARROW/extent","name":"Super-Region"},{"type":"constituent","scheme":"https://www.sciencebase.gov/vocab/SPARROW/constituent","name":"TN"}]},{"link":{"rel":"self","url":"https://www.sciencebase.gov/catalog/item/55ce4031e4b01487cbfc70c2"},"relatedItems":{"link":{"url":"https://www.sciencebase.gov/catalog/itemLinks?itemId=55ce4031e4b01487cbfc70c2","rel":"related"}},"id":"55ce4031e4b01487cbfc70c2","tags":[{"type":"region","scheme":"https://www.sciencebase.gov/vocab/SPARROW/region","name":"Conterminous US"},{"type":"id","scheme":"https://www.sciencebase.gov/vocab/SPARROW/sparrow-id","name":"30"},{"type":"extent","scheme":"https://www.sciencebase.gov/vocab/SPARROW/extent","name":"Conterminous US"},{"type":"constituent","scheme":"https://www.sciencebase.gov/vocab/SPARROW/constituent","name":"Susp. Sediment"}]},{"link":{"rel":"self","url":"https://www.sciencebase.gov/catalog/item/55ce4032e4b01487cbfc70d8"},"relatedItems":{"link":{"url":"https://www.sciencebase.gov/catalog/itemLinks?itemId=55ce4032e4b01487cbfc70d8","rel":"related"}},"id":"55ce4032e4b01487cbfc70d8","tags":[{"type":"region","scheme":"https://www.sciencebase.gov/vocab/SPARROW/region","name":"Upper Midwest (MRB3)"},{"type":"id","scheme":"https://www.sciencebase.gov/vocab/SPARROW/sparrow-id","name":"41"},{"type":"extent","scheme":"https://www.sciencebase.gov/vocab/SPARROW/extent","name":"Region (MRB) - Default for state selection"},{"type":"constituent","scheme":"https://www.sciencebase.gov/vocab/SPARROW/constituent","name":"TN"}]},{"link":{"rel":"self","url":"https://www.sciencebase.gov/catalog/item/55ce4032e4b01487cbfc70e0"},"relatedItems":{"link":{"url":"https://www.sciencebase.gov/catalog/itemLinks?itemId=55ce4032e4b01487cbfc70e0","rel":"related"}},"id":"55ce4032e4b01487cbfc70e0","tags":[{"type":"region","scheme":"https://www.sciencebase.gov/vocab/SPARROW/region","name":"Lower Midwest (MRB5)"},{"type":"id","scheme":"https://www.sciencebase.gov/vocab/SPARROW/sparrow-id","name":"35"},{"type":"extent","scheme":"https://www.sciencebase.gov/vocab/SPARROW/extent","name":"Region (MRB) - Default for state selection"},{"type":"constituent","scheme":"https://www.sciencebase.gov/vocab/SPARROW/constituent","name":"TN"}]},{"link":{"rel":"self","url":"https://www.sciencebase.gov/catalog/item/55ce4031e4b01487cbfc70ca"},"relatedItems":{"link":{"url":"https://www.sciencebase.gov/catalog/itemLinks?itemId=55ce4031e4b01487cbfc70ca","rel":"related"}},"id":"55ce4031e4b01487cbfc70ca","tags":[{"type":"region","scheme":"https://www.sciencebase.gov/vocab/SPARROW/region","name":"Mississippi"},{"type":"id","scheme":"https://www.sciencebase.gov/vocab/SPARROW/sparrow-id","name":"38"},{"type":"extent","scheme":"https://www.sciencebase.gov/vocab/SPARROW/extent","name":"Super-Region"},{"type":"constituent","scheme":"https://www.sciencebase.gov/vocab/SPARROW/constituent","name":"TP"}]},{"link":{"rel":"self","url":"https://www.sciencebase.gov/catalog/item/55ce4031e4b01487cbfc70c0"},"relatedItems":{"link":{"url":"https://www.sciencebase.gov/catalog/itemLinks?itemId=55ce4031e4b01487cbfc70c0","rel":"related"}},"id":"55ce4031e4b01487cbfc70c0","tags":[{"type":"region","scheme":"https://www.sciencebase.gov/vocab/SPARROW/region","name":"Conterminous US"},{"type":"id","scheme":"https://www.sciencebase.gov/vocab/SPARROW/sparrow-id","name":"23"},{"type":"extent","scheme":"https://www.sciencebase.gov/vocab/SPARROW/extent","name":"Conterminous US"},{"type":"constituent","scheme":"https://www.sciencebase.gov/vocab/SPARROW/constituent","name":"TP"}]},{"link":{"rel":"self","url":"https://www.sciencebase.gov/catalog/item/55ce4032e4b01487cbfc70ea"},"relatedItems":{"link":{"url":"https://www.sciencebase.gov/catalog/itemLinks?itemId=55ce4032e4b01487cbfc70ea","rel":"related"}},"id":"55ce4032e4b01487cbfc70ea","tags":[{"type":"region","scheme":"https://www.sciencebase.gov/vocab/SPARROW/region","name":"California (MRB8)"},{"type":"id","scheme":"https://www.sciencebase.gov/vocab/SPARROW/sparrow-id","name":"New"},{"type":"extent","scheme":"https://www.sciencebase.gov/vocab/SPARROW/extent","name":"Region (MRB) - Default for state selection"},{"type":"constituent","scheme":"https://www.sciencebase.gov/vocab/SPARROW/constituent","name":"TP"}]},{"link":{"rel":"self","url":"https://www.sciencebase.gov/catalog/item/55ce4032e4b01487cbfc70e2"},"relatedItems":{"link":{"url":"https://www.sciencebase.gov/catalog/itemLinks?itemId=55ce4032e4b01487cbfc70e2","rel":"related"}},"id":"55ce4032e4b01487cbfc70e2","tags":[{"type":"region","scheme":"https://www.sciencebase.gov/vocab/SPARROW/region","name":"Lower Midwest (MRB5)"},{"type":"id","scheme":"https://www.sciencebase.gov/vocab/SPARROW/sparrow-id","name":"36"},{"type":"extent","scheme":"https://www.sciencebase.gov/vocab/SPARROW/extent","name":"Region (MRB) - Default for state selection"},{"type":"constituent","scheme":"https://www.sciencebase.gov/vocab/SPARROW/constituent","name":"TP"}]},{"link":{"rel":"self","url":"https://www.sciencebase.gov/catalog/item/55ce4033e4b01487cbfc70f2"},"relatedItems":{"link":{"url":"https://www.sciencebase.gov/catalog/itemLinks?itemId=55ce4033e4b01487cbfc70f2","rel":"related"}},"id":"55ce4033e4b01487cbfc70f2","tags":[{"type":"region","scheme":"https://www.sciencebase.gov/vocab/SPARROW/region","name":"Southwestern US"},{"type":"id","scheme":"https://www.sciencebase.gov/vocab/SPARROW/sparrow-id","name":"53"},{"type":"extent","scheme":"https://www.sciencebase.gov/vocab/SPARROW/extent","name":"Sub- Region"},{"type":"constituent","scheme":"https://www.sciencebase.gov/vocab/SPARROW/constituent","name":"TDS"}]},{"link":{"rel":"self","url":"https://www.sciencebase.gov/catalog/item/55ce4032e4b01487cbfc70ec"},"relatedItems":{"link":{"url":"https://www.sciencebase.gov/catalog/itemLinks?itemId=55ce4032e4b01487cbfc70ec","rel":"related"}},"id":"55ce4032e4b01487cbfc70ec","tags":[{"type":"region","scheme":"https://www.sciencebase.gov/vocab/SPARROW/region","name":"Chesapeake Bay"},{"type":"id","scheme":"https://www.sciencebase.gov/vocab/SPARROW/sparrow-id","name":"54"},{"type":"extent","scheme":"https://www.sciencebase.gov/vocab/SPARROW/extent","name":"Sub- Region"},{"type":"constituent","scheme":"https://www.sciencebase.gov/vocab/SPARROW/constituent","name":"TN"}]},{"link":{"rel":"self","url":"https://www.sciencebase.gov/catalog/item/55ce4032e4b01487cbfc70da"},"relatedItems":{"link":{"url":"https://www.sciencebase.gov/catalog/itemLinks?itemId=55ce4032e4b01487cbfc70da","rel":"related"}},"id":"55ce4032e4b01487cbfc70da","tags":[{"type":"region","scheme":"https://www.sciencebase.gov/vocab/SPARROW/region","name":"Upper Midwest (MRB3)"},{"type":"id","scheme":"https://www.sciencebase.gov/vocab/SPARROW/sparrow-id","name":"42"},{"type":"extent","scheme":"https://www.sciencebase.gov/vocab/SPARROW/extent","name":"Region (MRB) - Default for state selection"},{"type":"constituent","scheme":"https://www.sciencebase.gov/vocab/SPARROW/constituent","name":"TP"}]},{"link":{"rel":"self","url":"https://www.sciencebase.gov/catalog/item/55ce4032e4b01487cbfc70e4"},"relatedItems":{"link":{"url":"https://www.sciencebase.gov/catalog/itemLinks?itemId=55ce4032e4b01487cbfc70e4","rel":"related"}},"id":"55ce4032e4b01487cbfc70e4","tags":[{"type":"region","scheme":"https://www.sciencebase.gov/vocab/SPARROW/region","name":"Pacific Northwest (MRB7)"},{"type":"id","scheme":"https://www.sciencebase.gov/vocab/SPARROW/sparrow-id","name":"43"},{"type":"extent","scheme":"https://www.sciencebase.gov/vocab/SPARROW/extent","name":"Region (MRB) - Default for state selection"},{"type":"constituent","scheme":"https://www.sciencebase.gov/vocab/SPARROW/constituent","name":"TN"}]},{"link":{"rel":"self","url":"https://www.sciencebase.gov/catalog/item/55ce4031e4b01487cbfc70d0"},"relatedItems":{"link":{"url":"https://www.sciencebase.gov/catalog/itemLinks?itemId=55ce4031e4b01487cbfc70d0","rel":"related"}},"id":"55ce4031e4b01487cbfc70d0","tags":[{"type":"region","scheme":"https://www.sciencebase.gov/vocab/SPARROW/region","name":"Northeast (MRB1)"},{"type":"id","scheme":"https://www.sciencebase.gov/vocab/SPARROW/sparrow-id","name":"51"},{"type":"extent","scheme":"https://www.sciencebase.gov/vocab/SPARROW/extent","name":"Region (MRB) - Default for state selection"},{"type":"constituent","scheme":"https://www.sciencebase.gov/vocab/SPARROW/constituent","name":"TN"}]},{"link":{"rel":"self","url":"https://www.sciencebase.gov/catalog/item/55ce4033e4b01487cbfc70f0"},"relatedItems":{"link":{"url":"https://www.sciencebase.gov/catalog/itemLinks?itemId=55ce4033e4b01487cbfc70f0","rel":"related"}},"id":"55ce4033e4b01487cbfc70f0","tags":[{"type":"region","scheme":"https://www.sciencebase.gov/vocab/SPARROW/region","name":"Chesapeake Bay"},{"type":"id","scheme":"https://www.sciencebase.gov/vocab/SPARROW/sparrow-id","name":"New"},{"type":"extent","scheme":"https://www.sciencebase.gov/vocab/SPARROW/extent","name":"Sub- Region"},{"type":"constituent","scheme":"https://www.sciencebase.gov/vocab/SPARROW/constituent","name":"Susp. Sediment"}]},{"link":{"rel":"self","url":"https://www.sciencebase.gov/catalog/item/55ce4031e4b01487cbfc70c8"},"relatedItems":{"link":{"url":"https://www.sciencebase.gov/catalog/itemLinks?itemId=55ce4031e4b01487cbfc70c8","rel":"related"}},"id":"55ce4031e4b01487cbfc70c8","tags":[{"type":"region","scheme":"https://www.sciencebase.gov/vocab/SPARROW/region","name":"Mississippi"},{"type":"id","scheme":"https://www.sciencebase.gov/vocab/SPARROW/sparrow-id","name":"37"},{"type":"extent","scheme":"https://www.sciencebase.gov/vocab/SPARROW/extent","name":"Super-Region"},{"type":"constituent","scheme":"https://www.sciencebase.gov/vocab/SPARROW/constituent","name":"TN"}]},{"link":{"rel":"self","url":"https://www.sciencebase.gov/catalog/item/55ce4032e4b01487cbfc70d2"},"relatedItems":{"link":{"url":"https://www.sciencebase.gov/catalog/itemLinks?itemId=55ce4032e4b01487cbfc70d2","rel":"related"}},"id":"55ce4032e4b01487cbfc70d2","tags":[{"type":"region","scheme":"https://www.sciencebase.gov/vocab/SPARROW/region","name":"Northeast (MRB1)"},{"type":"id","scheme":"https://www.sciencebase.gov/vocab/SPARROW/sparrow-id","name":"52"},{"type":"extent","scheme":"https://www.sciencebase.gov/vocab/SPARROW/extent","name":"Region (MRB) - Default for state selection"},{"type":"constituent","scheme":"https://www.sciencebase.gov/vocab/SPARROW/constituent","name":"TP"}]},{"link":{"rel":"self","url":"https://www.sciencebase.gov/catalog/item/55ce4032e4b01487cbfc70ee"},"relatedItems":{"link":{"url":"https://www.sciencebase.gov/catalog/itemLinks?itemId=55ce4032e4b01487cbfc70ee","rel":"related"}},"id":"55ce4032e4b01487cbfc70ee","tags":[{"type":"region","scheme":"https://www.sciencebase.gov/vocab/SPARROW/region","name":"Chesapeake Bay"},{"type":"id","scheme":"https://www.sciencebase.gov/vocab/SPARROW/sparrow-id","name":"55"},{"type":"extent","scheme":"https://www.sciencebase.gov/vocab/SPARROW/extent","name":"Sub- Region"},{"type":"constituent","scheme":"https://www.sciencebase.gov/vocab/SPARROW/constituent","name":"TP"}]},{"link":{"rel":"self","url":"https://www.sciencebase.gov/catalog/item/55ce4032e4b01487cbfc70dc"},"relatedItems":{"link":{"url":"https://www.sciencebase.gov/catalog/itemLinks?itemId=55ce4032e4b01487cbfc70dc","rel":"related"}},"id":"55ce4032e4b01487cbfc70dc","tags":[{"type":"region","scheme":"https://www.sciencebase.gov/vocab/SPARROW/region","name":"Missouri (MRB4)"},{"type":"id","scheme":"https://www.sciencebase.gov/vocab/SPARROW/sparrow-id","name":"57"},{"type":"extent","scheme":"https://www.sciencebase.gov/vocab/SPARROW/extent","name":"Region (MRB) - Default for state selection"},{"type":"constituent","scheme":"https://www.sciencebase.gov/vocab/SPARROW/constituent","name":"TN"}]},{"link":{"rel":"self","url":"https://www.sciencebase.gov/catalog/item/55ce4032e4b01487cbfc70e6"},"relatedItems":{"link":{"url":"https://www.sciencebase.gov/catalog/itemLinks?itemId=55ce4032e4b01487cbfc70e6","rel":"related"}},"id":"55ce4032e4b01487cbfc70e6","tags":[{"type":"region","scheme":"https://www.sciencebase.gov/vocab/SPARROW/region","name":"Pacific Northwest (MRB7)"},{"type":"id","scheme":"https://www.sciencebase.gov/vocab/SPARROW/sparrow-id","name":"44"},{"type":"extent","scheme":"https://www.sciencebase.gov/vocab/SPARROW/extent","name":"Region (MRB) - Default for state selection"},{"type":"constituent","scheme":"https://www.sciencebase.gov/vocab/SPARROW/constituent","name":"TP"}]},{"link":{"rel":"self","url":"https://www.sciencebase.gov/catalog/item/55ce4031e4b01487cbfc70bd"},"relatedItems":{"link":{"url":"https://www.sciencebase.gov/catalog/itemLinks?itemId=55ce4031e4b01487cbfc70bd","rel":"related"}},"id":"55ce4031e4b01487cbfc70bd","tags":[{"type":"region","scheme":"https://www.sciencebase.gov/vocab/SPARROW/region","name":"Conterminous US"},{"type":"id","scheme":"https://www.sciencebase.gov/vocab/SPARROW/sparrow-id","name":"22"},{"type":"extent","scheme":"https://www.sciencebase.gov/vocab/SPARROW/extent","name":"Conterminous US"},{"type":"constituent","scheme":"https://www.sciencebase.gov/vocab/SPARROW/constituent","name":"TN"}]}]};
		var coll;

		beforeEach(function () {
			this.server = sinon.fakeServer.create();
			this.server.respondWith("GET", "data/model", [
				200,
				{"Content-Type": "application/json"},
				JSON.stringify(json)
			]);

			coll = new ModelCollection();
			coll.fetch();
			this.server.respond();
		});

		it("properly fetches models", function () {

			expect(coll.models.length).toBeGreaterThan(0);
			expect(coll.models.length).toBe(23);
			expect(_.findIndex(coll.models, function(m) {
				return m.attributes = {
					id : '50',
				    sbId : '55ce4032e4b01487cbfc70d4',
					link : {
						rel : 'self',
						url : 'https://www.sciencebase.gov/catalog/item/55ce4032e4b01487cbfc70d4'
					},
					relatedLink : 'https://www.sciencebase.gov/catalog/itemLinks?itemId=55ce4032e4b01487cbfc70d4',
					region : 'Southeast (MRB2)',
					extent : 'Region (MRB) - Default for state selection',
					constituent : 'TN'
				};
			})).not.toBe(-1);
		});

		it('getConstituents returns all constituents if not filtered by region', function() {
			var c = coll.getConstituents();
			expect(c.length).toBe(5);
			expect(c).toContain('TN');
			expect(c).toContain('TP');
			expect(c).toContain('TDS');
			expect(c).toContain('Susp. Sediment');
			expect(c).toContain('TOC');
		});

		it('getConstituents returns relevant constituents if filtered by region', function() {
			var c = coll.getConstituents('Missouri (MRB4)');
			expect(c.length).toBe(2);
			expect(c).toContain('TN');
			expect(c).toContain('TP');
		});

		it('getConstituents returns empty array if filtered by a invalid region', function() {
			var c = coll.getConstituents('No Region');
			expect(c.length).toBe(0);
		});

		it('getRegions returns all regions if not filtered by constituent', function() {
			var r = coll.getRegions();
			expect(r.length).toBe(10);
			expect(r).toContain('Conterminous US');
			expect(r).toContain('Southeast (MRB2)');
			expect(r).toContain('Missouri (MRB4)');
			expect(r).toContain('Chesapeake Bay');
			expect(r).toContain('Southwestern US');
			expect(r).toContain('Mississippi');
			expect(r).toContain('Lower Midwest (MRB5)');
			expect(r).toContain('Northeast (MRB1)');
			expect(r).toContain('Upper Midwest (MRB3)');
			expect(r).toContain('Pacific Northwest (MRB7)');
		});

		it('getRegions returns relevant regions if filtered by constituent', function() {
			var r = coll.getRegions('TDS');
			expect(r.length).toBe(2);
			expect(r).toContain('Southwestern US');
			expect(r).toContain('Conterminous US');
		});

		it('Expects getRegions to return an empty array if filtered by a invalid constituent', function() {
			var r = coll.getRegions('no constituent');
			expect(r.length).toBe(0);
		});

		it('Expects getId to return the model id for the region and constituent', function() {
			expect(coll.getId('TN', 'Missouri (MRB4)')).toEqual('57');
			expect(coll.getId('TDS', 'Missouri (MRB4)')).not.toBeDefined();
			expect(coll.getId('', '')).not.toBeDefined();
			expect(coll.getId('TN', '')).not.toBeDefined();
		});

		afterEach(function () {
			this.server.restore();
		});
	});
});