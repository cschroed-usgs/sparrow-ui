/* global expect */

define([
	"sinon",
	'utils/spatialUtils'
], function (sinon, SpatialUtils) {
	describe("SpatialUtils", function () {

		var validRequestResponse = {"type":"FeatureCollection","totalFeatures":377,"features":[{"type":"Feature","id":"mrb05_mrbe2rf1.1","geometry":null,"properties":{"States":"NM,CO"}},{"type":"Feature","id":"mrb05_mrbe2rf1.2","geometry":null,"properties":{"States":"NM"}},{"type":"Feature","id":"mrb05_mrbe2rf1.3","geometry":null,"properties":{"States":"NM"}},{"type":"Feature","id":"mrb05_mrbe2rf1.4","geometry":null,"properties":{"States":"NM"}},{"type":"Feature","id":"mrb05_mrbe2rf1.5","geometry":null,"properties":{"States":"NM"}},{"type":"Feature","id":"mrb05_mrbe2rf1.6","geometry":null,"properties":{"States":"NM"}},{"type":"Feature","id":"mrb05_mrbe2rf1.7","geometry":null,"properties":{"States":"NM"}},{"type":"Feature","id":"mrb05_mrbe2rf1.8","geometry":null,"properties":{"States":"NM"}},{"type":"Feature","id":"mrb05_mrbe2rf1.9","geometry":null,"properties":{"States":"CO,NM"}},{"type":"Feature","id":"mrb05_mrbe2rf1.10","geometry":null,"properties":{"States":"NM,TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.11","geometry":null,"properties":{"States":"NM"}},{"type":"Feature","id":"mrb05_mrbe2rf1.12","geometry":null,"properties":{"States":"NM,TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.13","geometry":null,"properties":{"States":"OK"}},{"type":"Feature","id":"mrb05_mrbe2rf1.14","geometry":null,"properties":{"States":"OK"}},{"type":"Feature","id":"mrb05_mrbe2rf1.15","geometry":null,"properties":{"States":"OK"}},{"type":"Feature","id":"mrb05_mrbe2rf1.16","geometry":null,"properties":{"States":"OK"}},{"type":"Feature","id":"mrb05_mrbe2rf1.17","geometry":null,"properties":{"States":"OK,KS"}},{"type":"Feature","id":"mrb05_mrbe2rf1.18","geometry":null,"properties":{"States":"OK"}},{"type":"Feature","id":"mrb05_mrbe2rf1.19","geometry":null,"properties":{"States":"OK"}},{"type":"Feature","id":"mrb05_mrbe2rf1.20","geometry":null,"properties":{"States":"OK"}},{"type":"Feature","id":"mrb05_mrbe2rf1.21","geometry":null,"properties":{"States":"OK"}},{"type":"Feature","id":"mrb05_mrbe2rf1.22","geometry":null,"properties":{"States":"OK"}},{"type":"Feature","id":"mrb05_mrbe2rf1.23","geometry":null,"properties":{"States":"OK"}},{"type":"Feature","id":"mrb05_mrbe2rf1.24","geometry":null,"properties":{"States":"OK"}},{"type":"Feature","id":"mrb05_mrbe2rf1.25","geometry":null,"properties":{"States":"OK"}},{"type":"Feature","id":"mrb05_mrbe2rf1.26","geometry":null,"properties":{"States":"OK"}},{"type":"Feature","id":"mrb05_mrbe2rf1.27","geometry":null,"properties":{"States":"OK"}},{"type":"Feature","id":"mrb05_mrbe2rf1.28","geometry":null,"properties":{"States":"OK"}},{"type":"Feature","id":"mrb05_mrbe2rf1.29","geometry":null,"properties":{"States":"OK"}},{"type":"Feature","id":"mrb05_mrbe2rf1.30","geometry":null,"properties":{"States":"OK"}},{"type":"Feature","id":"mrb05_mrbe2rf1.31","geometry":null,"properties":{"States":"OK"}},{"type":"Feature","id":"mrb05_mrbe2rf1.32","geometry":null,"properties":{"States":"OK"}},{"type":"Feature","id":"mrb05_mrbe2rf1.33","geometry":null,"properties":{"States":"AR,OK"}},{"type":"Feature","id":"mrb05_mrbe2rf1.34","geometry":null,"properties":{"States":"AR,OK"}},{"type":"Feature","id":"mrb05_mrbe2rf1.35","geometry":null,"properties":{"States":"AR,OK"}},{"type":"Feature","id":"mrb05_mrbe2rf1.36","geometry":null,"properties":{"States":"AR,OK"}},{"type":"Feature","id":"mrb05_mrbe2rf1.37","geometry":null,"properties":{"States":"AR"}},{"type":"Feature","id":"mrb05_mrbe2rf1.38","geometry":null,"properties":{"States":"CO,KS,OK"}},{"type":"Feature","id":"mrb05_mrbe2rf1.39","geometry":null,"properties":{"States":"KS"}},{"type":"Feature","id":"mrb05_mrbe2rf1.40","geometry":null,"properties":{"States":"KS,OK"}},{"type":"Feature","id":"mrb05_mrbe2rf1.41","geometry":null,"properties":{"States":"KS,OK"}},{"type":"Feature","id":"mrb05_mrbe2rf1.42","geometry":null,"properties":{"States":"KS,OK"}},{"type":"Feature","id":"mrb05_mrbe2rf1.43","geometry":null,"properties":{"States":"KS"}},{"type":"Feature","id":"mrb05_mrbe2rf1.44","geometry":null,"properties":{"States":"KS,OK"}},{"type":"Feature","id":"mrb05_mrbe2rf1.45","geometry":null,"properties":{"States":"KS,OK"}},{"type":"Feature","id":"mrb05_mrbe2rf1.46","geometry":null,"properties":{"States":"OK,TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.47","geometry":null,"properties":{"States":"OK"}},{"type":"Feature","id":"mrb05_mrbe2rf1.48","geometry":null,"properties":{"States":"OK"}},{"type":"Feature","id":"mrb05_mrbe2rf1.49","geometry":null,"properties":{"States":"OK,TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.50","geometry":null,"properties":{"States":"OK"}},{"type":"Feature","id":"mrb05_mrbe2rf1.51","geometry":null,"properties":{"States":"OK,TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.52","geometry":null,"properties":{"States":"NM,OK"}},{"type":"Feature","id":"mrb05_mrbe2rf1.53","geometry":null,"properties":{"States":"OK"}},{"type":"Feature","id":"mrb05_mrbe2rf1.54","geometry":null,"properties":{"States":"OK,TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.55","geometry":null,"properties":{"States":"OK,KS"}},{"type":"Feature","id":"mrb05_mrbe2rf1.56","geometry":null,"properties":{"States":"OK"}},{"type":"Feature","id":"mrb05_mrbe2rf1.57","geometry":null,"properties":{"States":"OK"}},{"type":"Feature","id":"mrb05_mrbe2rf1.58","geometry":null,"properties":{"States":"OK"}},{"type":"Feature","id":"mrb05_mrbe2rf1.59","geometry":null,"properties":{"States":"OK"}},{"type":"Feature","id":"mrb05_mrbe2rf1.60","geometry":null,"properties":{"States":"OK,AR"}},{"type":"Feature","id":"mrb05_mrbe2rf1.61","geometry":null,"properties":{"States":"TN"}},{"type":"Feature","id":"mrb05_mrbe2rf1.62","geometry":null,"properties":{"States":"TN"}},{"type":"Feature","id":"mrb05_mrbe2rf1.63","geometry":null,"properties":{"States":"TN"}},{"type":"Feature","id":"mrb05_mrbe2rf1.64","geometry":null,"properties":{"States":"TN"}},{"type":"Feature","id":"mrb05_mrbe2rf1.65","geometry":null,"properties":{"States":"TN"}},{"type":"Feature","id":"mrb05_mrbe2rf1.66","geometry":null,"properties":{"States":"KY,TN"}},{"type":"Feature","id":"mrb05_mrbe2rf1.67","geometry":null,"properties":{"States":"TN,MS"}},{"type":"Feature","id":"mrb05_mrbe2rf1.68","geometry":null,"properties":{"States":"MS,TN"}},{"type":"Feature","id":"mrb05_mrbe2rf1.69","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.70","geometry":null,"properties":{"States":"TX,OK"}},{"type":"Feature","id":"mrb05_mrbe2rf1.71","geometry":null,"properties":{"States":"TX,OK,NM"}},{"type":"Feature","id":"mrb05_mrbe2rf1.72","geometry":null,"properties":{"States":"TX,OK"}},{"type":"Feature","id":"mrb05_mrbe2rf1.73","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.74","geometry":null,"properties":{"States":"AR"}},{"type":"Feature","id":"mrb05_mrbe2rf1.75","geometry":null,"properties":{"States":"AR"}},{"type":"Feature","id":"mrb05_mrbe2rf1.76","geometry":null,"properties":{"States":"AR"}},{"type":"Feature","id":"mrb05_mrbe2rf1.77","geometry":null,"properties":{"States":"AR"}},{"type":"Feature","id":"mrb05_mrbe2rf1.78","geometry":null,"properties":{"States":"AR"}},{"type":"Feature","id":"mrb05_mrbe2rf1.79","geometry":null,"properties":{"States":"AR"}},{"type":"Feature","id":"mrb05_mrbe2rf1.80","geometry":null,"properties":{"States":"AR"}},{"type":"Feature","id":"mrb05_mrbe2rf1.81","geometry":null,"properties":{"States":"AR"}},{"type":"Feature","id":"mrb05_mrbe2rf1.82","geometry":null,"properties":{"States":"AR"}},{"type":"Feature","id":"mrb05_mrbe2rf1.83","geometry":null,"properties":{"States":"AR"}},{"type":"Feature","id":"mrb05_mrbe2rf1.84","geometry":null,"properties":{"States":"AR"}},{"type":"Feature","id":"mrb05_mrbe2rf1.85","geometry":null,"properties":{"States":"AR"}},{"type":"Feature","id":"mrb05_mrbe2rf1.86","geometry":null,"properties":{"States":"AR"}},{"type":"Feature","id":"mrb05_mrbe2rf1.87","geometry":null,"properties":{"States":"AR"}},{"type":"Feature","id":"mrb05_mrbe2rf1.88","geometry":null,"properties":{"States":"AR"}},{"type":"Feature","id":"mrb05_mrbe2rf1.89","geometry":null,"properties":{"States":"AR"}},{"type":"Feature","id":"mrb05_mrbe2rf1.90","geometry":null,"properties":{"States":"AR"}},{"type":"Feature","id":"mrb05_mrbe2rf1.91","geometry":null,"properties":{"States":"AR"}},{"type":"Feature","id":"mrb05_mrbe2rf1.92","geometry":null,"properties":{"States":"AR"}},{"type":"Feature","id":"mrb05_mrbe2rf1.93","geometry":null,"properties":{"States":"AR"}},{"type":"Feature","id":"mrb05_mrbe2rf1.94","geometry":null,"properties":{"States":"AR"}},{"type":"Feature","id":"mrb05_mrbe2rf1.95","geometry":null,"properties":{"States":"AR"}},{"type":"Feature","id":"mrb05_mrbe2rf1.96","geometry":null,"properties":{"States":"AR"}},{"type":"Feature","id":"mrb05_mrbe2rf1.97","geometry":null,"properties":{"States":"AR"}},{"type":"Feature","id":"mrb05_mrbe2rf1.98","geometry":null,"properties":{"States":"AR"}},{"type":"Feature","id":"mrb05_mrbe2rf1.99","geometry":null,"properties":{"States":"AR"}},{"type":"Feature","id":"mrb05_mrbe2rf1.100","geometry":null,"properties":{"States":"AR"}},{"type":"Feature","id":"mrb05_mrbe2rf1.101","geometry":null,"properties":{"States":"AR"}},{"type":"Feature","id":"mrb05_mrbe2rf1.102","geometry":null,"properties":{"States":"AR"}},{"type":"Feature","id":"mrb05_mrbe2rf1.103","geometry":null,"properties":{"States":"AR,MO"}},{"type":"Feature","id":"mrb05_mrbe2rf1.104","geometry":null,"properties":{"States":"AR,MO"}},{"type":"Feature","id":"mrb05_mrbe2rf1.105","geometry":null,"properties":{"States":"AR"}},{"type":"Feature","id":"mrb05_mrbe2rf1.106","geometry":null,"properties":{"States":"AR,MO"}},{"type":"Feature","id":"mrb05_mrbe2rf1.107","geometry":null,"properties":{"States":"AR,MO"}},{"type":"Feature","id":"mrb05_mrbe2rf1.108","geometry":null,"properties":{"States":"AR,MO"}},{"type":"Feature","id":"mrb05_mrbe2rf1.109","geometry":null,"properties":{"States":"AR,MO"}},{"type":"Feature","id":"mrb05_mrbe2rf1.110","geometry":null,"properties":{"States":"AR"}},{"type":"Feature","id":"mrb05_mrbe2rf1.111","geometry":null,"properties":{"States":"AR,MO,OK,KS"}},{"type":"Feature","id":"mrb05_mrbe2rf1.112","geometry":null,"properties":{"States":"AR,TN,KY"}},{"type":"Feature","id":"mrb05_mrbe2rf1.113","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.114","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.115","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.116","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.117","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.118","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.119","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.120","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.121","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.122","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.123","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.124","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.125","geometry":null,"properties":{"States":"TX,AR,OK"}},{"type":"Feature","id":"mrb05_mrbe2rf1.126","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.127","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.128","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.129","geometry":null,"properties":{"States":"TX,LA"}},{"type":"Feature","id":"mrb05_mrbe2rf1.130","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.131","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.132","geometry":null,"properties":{"States":"TX,LA"}},{"type":"Feature","id":"mrb05_mrbe2rf1.133","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.134","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.135","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.136","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.137","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.138","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.139","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.140","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.141","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.142","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.143","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.144","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.145","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.146","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.147","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.148","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.149","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.150","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.151","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.152","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.153","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.154","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.155","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.156","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.157","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.158","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.159","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.160","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.161","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.162","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.163","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.164","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.165","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.166","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.167","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.168","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.169","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.170","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.171","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.172","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.173","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.174","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.175","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.176","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.177","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.178","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.179","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.180","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.181","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.182","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.183","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.184","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.185","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.186","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.187","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.188","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.189","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.190","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.191","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.192","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.193","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.194","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.195","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.196","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.197","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.198","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.199","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.200","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.201","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.202","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.203","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.204","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.205","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.206","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.207","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.208","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.209","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.210","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.211","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.212","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.213","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.214","geometry":null,"properties":{"States":"AR"}},{"type":"Feature","id":"mrb05_mrbe2rf1.215","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.216","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.217","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.218","geometry":null,"properties":{"States":"KS"}},{"type":"Feature","id":"mrb05_mrbe2rf1.219","geometry":null,"properties":{"States":"KS"}},{"type":"Feature","id":"mrb05_mrbe2rf1.220","geometry":null,"properties":{"States":"LA"}},{"type":"Feature","id":"mrb05_mrbe2rf1.221","geometry":null,"properties":{"States":"MS"}},{"type":"Feature","id":"mrb05_mrbe2rf1.222","geometry":null,"properties":{"States":"CO"}},{"type":"Feature","id":"mrb05_mrbe2rf1.223","geometry":null,"properties":{"States":"CO"}},{"type":"Feature","id":"mrb05_mrbe2rf1.224","geometry":null,"properties":{"States":"CO"}},{"type":"Feature","id":"mrb05_mrbe2rf1.225","geometry":null,"properties":{"States":"CO"}},{"type":"Feature","id":"mrb05_mrbe2rf1.226","geometry":null,"properties":{"States":"CO"}},{"type":"Feature","id":"mrb05_mrbe2rf1.227","geometry":null,"properties":{"States":"CO"}},{"type":"Feature","id":"mrb05_mrbe2rf1.228","geometry":null,"properties":{"States":"CO"}},{"type":"Feature","id":"mrb05_mrbe2rf1.229","geometry":null,"properties":{"States":"CO"}},{"type":"Feature","id":"mrb05_mrbe2rf1.230","geometry":null,"properties":{"States":"CO"}},{"type":"Feature","id":"mrb05_mrbe2rf1.231","geometry":null,"properties":{"States":"CO"}},{"type":"Feature","id":"mrb05_mrbe2rf1.232","geometry":null,"properties":{"States":"CO"}},{"type":"Feature","id":"mrb05_mrbe2rf1.233","geometry":null,"properties":{"States":"CO"}},{"type":"Feature","id":"mrb05_mrbe2rf1.234","geometry":null,"properties":{"States":"CO"}},{"type":"Feature","id":"mrb05_mrbe2rf1.235","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.236","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.237","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.238","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.239","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.240","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.241","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.242","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.243","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.244","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.245","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.246","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.247","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.248","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.249","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.250","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.251","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.252","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.253","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.254","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.255","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.256","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.257","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.258","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.259","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.260","geometry":null,"properties":{"States":"TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.261","geometry":null,"properties":{"States":"AR,TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.262","geometry":null,"properties":{"States":"LA,TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.263","geometry":null,"properties":{"States":"LA,TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.264","geometry":null,"properties":{"States":"NM,TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.265","geometry":null,"properties":{"States":"NM,TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.266","geometry":null,"properties":{"States":"NM,TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.267","geometry":null,"properties":{"States":"NM,TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.268","geometry":null,"properties":{"States":"NM,TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.269","geometry":null,"properties":{"States":"NM,TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.270","geometry":null,"properties":{"States":"NM,TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.271","geometry":null,"properties":{"States":"NM,TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.272","geometry":null,"properties":{"States":"NM,TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.273","geometry":null,"properties":{"States":"NM,TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.274","geometry":null,"properties":{"States":"OK,TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.275","geometry":null,"properties":{"States":"OK"}},{"type":"Feature","id":"mrb05_mrbe2rf1.276","geometry":null,"properties":{"States":"OK,TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.277","geometry":null,"properties":{"States":"OK,TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.278","geometry":null,"properties":{"States":"OK,TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.279","geometry":null,"properties":{"States":"OK"}},{"type":"Feature","id":"mrb05_mrbe2rf1.280","geometry":null,"properties":{"States":"CO,KS"}},{"type":"Feature","id":"mrb05_mrbe2rf1.281","geometry":null,"properties":{"States":"CO,KS"}},{"type":"Feature","id":"mrb05_mrbe2rf1.282","geometry":null,"properties":{"States":"CO"}},{"type":"Feature","id":"mrb05_mrbe2rf1.283","geometry":null,"properties":{"States":"KS,CO"}},{"type":"Feature","id":"mrb05_mrbe2rf1.284","geometry":null,"properties":{"States":"KS"}},{"type":"Feature","id":"mrb05_mrbe2rf1.285","geometry":null,"properties":{"States":"KS"}},{"type":"Feature","id":"mrb05_mrbe2rf1.286","geometry":null,"properties":{"States":"KS"}},{"type":"Feature","id":"mrb05_mrbe2rf1.287","geometry":null,"properties":{"States":"KS"}},{"type":"Feature","id":"mrb05_mrbe2rf1.288","geometry":null,"properties":{"States":"KS"}},{"type":"Feature","id":"mrb05_mrbe2rf1.289","geometry":null,"properties":{"States":"KS"}},{"type":"Feature","id":"mrb05_mrbe2rf1.290","geometry":null,"properties":{"States":"KS"}},{"type":"Feature","id":"mrb05_mrbe2rf1.291","geometry":null,"properties":{"States":"KS"}},{"type":"Feature","id":"mrb05_mrbe2rf1.292","geometry":null,"properties":{"States":"KS"}},{"type":"Feature","id":"mrb05_mrbe2rf1.293","geometry":null,"properties":{"States":"KS"}},{"type":"Feature","id":"mrb05_mrbe2rf1.294","geometry":null,"properties":{"States":"KS"}},{"type":"Feature","id":"mrb05_mrbe2rf1.295","geometry":null,"properties":{"States":"KS"}},{"type":"Feature","id":"mrb05_mrbe2rf1.296","geometry":null,"properties":{"States":"KS"}},{"type":"Feature","id":"mrb05_mrbe2rf1.297","geometry":null,"properties":{"States":"KS"}},{"type":"Feature","id":"mrb05_mrbe2rf1.298","geometry":null,"properties":{"States":"KS"}},{"type":"Feature","id":"mrb05_mrbe2rf1.299","geometry":null,"properties":{"States":"KS"}},{"type":"Feature","id":"mrb05_mrbe2rf1.300","geometry":null,"properties":{"States":"KS"}},{"type":"Feature","id":"mrb05_mrbe2rf1.301","geometry":null,"properties":{"States":"KS"}},{"type":"Feature","id":"mrb05_mrbe2rf1.302","geometry":null,"properties":{"States":"KS"}},{"type":"Feature","id":"mrb05_mrbe2rf1.303","geometry":null,"properties":{"States":"KS"}},{"type":"Feature","id":"mrb05_mrbe2rf1.304","geometry":null,"properties":{"States":"LA"}},{"type":"Feature","id":"mrb05_mrbe2rf1.305","geometry":null,"properties":{"States":"LA"}},{"type":"Feature","id":"mrb05_mrbe2rf1.306","geometry":null,"properties":{"States":"LA"}},{"type":"Feature","id":"mrb05_mrbe2rf1.307","geometry":null,"properties":{"States":"LA"}},{"type":"Feature","id":"mrb05_mrbe2rf1.308","geometry":null,"properties":{"States":"LA"}},{"type":"Feature","id":"mrb05_mrbe2rf1.309","geometry":null,"properties":{"States":"LA"}},{"type":"Feature","id":"mrb05_mrbe2rf1.310","geometry":null,"properties":{"States":"LA"}},{"type":"Feature","id":"mrb05_mrbe2rf1.311","geometry":null,"properties":{"States":"AR,LA"}},{"type":"Feature","id":"mrb05_mrbe2rf1.312","geometry":null,"properties":{"States":"AR,LA"}},{"type":"Feature","id":"mrb05_mrbe2rf1.313","geometry":null,"properties":{"States":"AR,LA"}},{"type":"Feature","id":"mrb05_mrbe2rf1.314","geometry":null,"properties":{"States":"AR,LA"}},{"type":"Feature","id":"mrb05_mrbe2rf1.315","geometry":null,"properties":{"States":"AR,LA"}},{"type":"Feature","id":"mrb05_mrbe2rf1.316","geometry":null,"properties":{"States":"AR,LA"}},{"type":"Feature","id":"mrb05_mrbe2rf1.317","geometry":null,"properties":{"States":"LA,MS"}},{"type":"Feature","id":"mrb05_mrbe2rf1.318","geometry":null,"properties":{"States":"LA,MS"}},{"type":"Feature","id":"mrb05_mrbe2rf1.319","geometry":null,"properties":{"States":"LA,MS"}},{"type":"Feature","id":"mrb05_mrbe2rf1.320","geometry":null,"properties":{"States":"LA"}},{"type":"Feature","id":"mrb05_mrbe2rf1.321","geometry":null,"properties":{"States":"LA"}},{"type":"Feature","id":"mrb05_mrbe2rf1.322","geometry":null,"properties":{"States":"AR,LA,MS"}},{"type":"Feature","id":"mrb05_mrbe2rf1.323","geometry":null,"properties":{"States":"LA,TX"}},{"type":"Feature","id":"mrb05_mrbe2rf1.324","geometry":null,"properties":{"States":"AR,LA"}},{"type":"Feature","id":"mrb05_mrbe2rf1.325","geometry":null,"properties":{"States":"KS"}},{"type":"Feature","id":"mrb05_mrbe2rf1.326","geometry":null,"properties":{"States":"KS"}},{"type":"Feature","id":"mrb05_mrbe2rf1.327","geometry":null,"properties":{"States":"KS"}},{"type":"Feature","id":"mrb05_mrbe2rf1.328","geometry":null,"properties":{"States":"CO,KS"}},{"type":"Feature","id":"mrb05_mrbe2rf1.329","geometry":null,"properties":{"States":"KS,MO"}},{"type":"Feature","id":"mrb05_mrbe2rf1.330","geometry":null,"properties":{"States":"KS"}},{"type":"Feature","id":"mrb05_mrbe2rf1.331","geometry":null,"properties":{"States":"KS"}},{"type":"Feature","id":"mrb05_mrbe2rf1.332","geometry":null,"properties":{"States":"KY"}},{"type":"Feature","id":"mrb05_mrbe2rf1.333","geometry":null,"properties":{"States":"LA"}},{"type":"Feature","id":"mrb05_mrbe2rf1.334","geometry":null,"properties":{"States":"LA"}},{"type":"Feature","id":"mrb05_mrbe2rf1.335","geometry":null,"properties":{"States":"LA"}},{"type":"Feature","id":"mrb05_mrbe2rf1.336","geometry":null,"properties":{"States":"LA"}},{"type":"Feature","id":"mrb05_mrbe2rf1.337","geometry":null,"properties":{"States":"LA"}},{"type":"Feature","id":"mrb05_mrbe2rf1.338","geometry":null,"properties":{"States":"LA"}},{"type":"Feature","id":"mrb05_mrbe2rf1.339","geometry":null,"properties":{"States":"LA"}},{"type":"Feature","id":"mrb05_mrbe2rf1.340","geometry":null,"properties":{"States":"LA"}},{"type":"Feature","id":"mrb05_mrbe2rf1.341","geometry":null,"properties":{"States":"LA"}},{"type":"Feature","id":"mrb05_mrbe2rf1.342","geometry":null,"properties":{"States":"LA"}},{"type":"Feature","id":"mrb05_mrbe2rf1.343","geometry":null,"properties":{"States":"LA"}},{"type":"Feature","id":"mrb05_mrbe2rf1.344","geometry":null,"properties":{"States":"LA"}},{"type":"Feature","id":"mrb05_mrbe2rf1.345","geometry":null,"properties":{"States":"LA"}},{"type":"Feature","id":"mrb05_mrbe2rf1.346","geometry":null,"properties":{"States":"LA"}},{"type":"Feature","id":"mrb05_mrbe2rf1.347","geometry":null,"properties":{"States":"LA"}},{"type":"Feature","id":"mrb05_mrbe2rf1.348","geometry":null,"properties":{"States":"LA"}},{"type":"Feature","id":"mrb05_mrbe2rf1.349","geometry":null,"properties":{"States":"LA"}},{"type":"Feature","id":"mrb05_mrbe2rf1.350","geometry":null,"properties":{"States":"LA"}},{"type":"Feature","id":"mrb05_mrbe2rf1.351","geometry":null,"properties":{"States":"LA"}},{"type":"Feature","id":"mrb05_mrbe2rf1.352","geometry":null,"properties":{"States":"LA"}},{"type":"Feature","id":"mrb05_mrbe2rf1.353","geometry":null,"properties":{"States":"LA"}},{"type":"Feature","id":"mrb05_mrbe2rf1.354","geometry":null,"properties":{"States":"LA"}},{"type":"Feature","id":"mrb05_mrbe2rf1.355","geometry":null,"properties":{"States":"LA"}},{"type":"Feature","id":"mrb05_mrbe2rf1.356","geometry":null,"properties":{"States":"LA"}},{"type":"Feature","id":"mrb05_mrbe2rf1.357","geometry":null,"properties":{"States":"LA"}},{"type":"Feature","id":"mrb05_mrbe2rf1.358","geometry":null,"properties":{"States":"LA"}},{"type":"Feature","id":"mrb05_mrbe2rf1.359","geometry":null,"properties":{"States":"MO"}},{"type":"Feature","id":"mrb05_mrbe2rf1.360","geometry":null,"properties":{"States":"MO"}},{"type":"Feature","id":"mrb05_mrbe2rf1.361","geometry":null,"properties":{"States":"MO"}},{"type":"Feature","id":"mrb05_mrbe2rf1.362","geometry":null,"properties":{"States":"AR,MO"}},{"type":"Feature","id":"mrb05_mrbe2rf1.363","geometry":null,"properties":{"States":"AR,MO"}},{"type":"Feature","id":"mrb05_mrbe2rf1.364","geometry":null,"properties":{"States":"MS"}},{"type":"Feature","id":"mrb05_mrbe2rf1.365","geometry":null,"properties":{"States":"MS"}},{"type":"Feature","id":"mrb05_mrbe2rf1.366","geometry":null,"properties":{"States":"MS"}},{"type":"Feature","id":"mrb05_mrbe2rf1.367","geometry":null,"properties":{"States":"MS"}},{"type":"Feature","id":"mrb05_mrbe2rf1.368","geometry":null,"properties":{"States":"MS"}},{"type":"Feature","id":"mrb05_mrbe2rf1.369","geometry":null,"properties":{"States":"MS"}},{"type":"Feature","id":"mrb05_mrbe2rf1.370","geometry":null,"properties":{"States":"MS"}},{"type":"Feature","id":"mrb05_mrbe2rf1.371","geometry":null,"properties":{"States":"MS"}},{"type":"Feature","id":"mrb05_mrbe2rf1.372","geometry":null,"properties":{"States":"MS,LA"}},{"type":"Feature","id":"mrb05_mrbe2rf1.373","geometry":null,"properties":{"States":"MS,LA"}},{"type":"Feature","id":"mrb05_mrbe2rf1.374","geometry":null,"properties":{"States":"MS"}},{"type":"Feature","id":"mrb05_mrbe2rf1.375","geometry":null,"properties":{"States":"MS"}},{"type":"Feature","id":"mrb05_mrbe2rf1.376","geometry":null,"properties":{"States":"MS,TN"}},{"type":"Feature","id":"mrb05_mrbe2rf1.377","geometry":null,"properties":{"States":"MS,TN"}}]};
		var noFeaturesResponse = {"type":"FeatureCollection","totalFeatures":0,"features":[]};
		
		beforeEach(function () {
			this.server = sinon.fakeServer.create();
			
			// Valid case
			this.server.respondWith("GET", "geoserver/huc8-overlay/ows?service=WFS&version=2.0.0&request=GetFeature&typeName=huc8-overlay%3Atest&propertyName=States&outputFormat=application%2Fjson", [
				200,
				{"Content-Type": "application/json"},
				JSON.stringify(validRequestResponse)
			]);
			
			// Invalid Case
			this.server.respondWith("GET", "geoserver/huc8-overlay/ows?service=WFS&version=2.0.0&request=GetFeature&typeName=huc8-overlay%3Amissing&propertyName=States&outputFormat=application%2Fjson", [
				200,
				{"Content-Type": "application/json"},
				JSON.stringify(noFeaturesResponse)
			]);
			
			// 404 Case
			this.server.respondWith("GET", "geoserver/huc8-overlay/ows?service=WFS&version=2.0.0&request=GetFeature&typeName=huc8-overlay%3A404&propertyName=States&outputFormat=application%2Fjson", [404, {}, ""]);
		});

		it("properly fetches features", function () {
			var test = SpatialUtils.getStatesForRegion("test", this);
			this.server.respond();
			test.always(function (data) {
				expect(data).not.toBe(null);
				expect(typeof data).toBe("object");
				expect(data.length).toBe(11);
				expect(data.indexOf("CO")).not.toBe(-1);
			});
		});
		
		it("properly handles getting back no features", function () {
			var test = SpatialUtils.getStatesForRegion("missing", this);
			this.server.respond();
			test.always(function (data) {
				expect(data).not.toBe(null);
				expect(typeof data).toBe("object");
				expect(data.length).toBe(0);
				expect(data.indexOf("CO")).toBe(-1);
			});
		});
		
		it("properly handles server errors", function () {
			var test = SpatialUtils.getStatesForRegion("404", this);
			this.server.respond();
			test.always(function (data) {
				expect(data).not.toBe(null);
				expect(typeof data).toBe("object");
				expect(data.status).toBe(404);
				expect(data.statusText).toBe("Not Found");
			});
		});

		afterEach(function () {
			this.server.restore();
		});
	});
});